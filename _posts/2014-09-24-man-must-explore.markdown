---
layout: post
title: Writeup WhiteHat Challenge 03
subtitle: Problems look mighty small from 150 miles up
date: 2017-04-30T00:00:00.000Z
author: Start Bootstrap
header-img: img/post-bg-06.jpg
published: true
---
<p><p>Đây là lần đầu tiên mình tham gia vào WhiteHat challenge, và chơi hẳn luôn một mình một team :v. Vì phải đi học sáng nên mình không thể tham gia khi cuộc thi bắt đầu vào lúc 9h sáng, nhưng những trải nghiệm mà cuộc thi đem lại cho mình phải nói là cực kì thú vị và phấn khích :D. Cũng không rõ nhờ năng lực nào mà mình có thể giải được 7/10 flags, thời điểm cao nhất có lúc nằm trong top 10 xếp hạng rồi :v, mà tiếc là thời gian khá ngắn ngủi, mình cũng không solve được thêm nữa nên đành chịu tụt xuống #20.</p><p>Đây là team mình, EHS là viết tắt tên trường mình :3.</p><figure data-orig-width="1365" data-orig-height="661" class="tmblr-full"><img src="https://68.media.tumblr.com/f39298556b0ed50f96e1f907eb84de87/tumblr_inline_op2nlx0byN1ux1xli_540.png" data-orig-width="1365" data-orig-height="661" alt="image"></figure>[[MORE]]<p><b>

Web001</b></p><blockquote><p>Sign in and get the flag in the following site.</p><p>URL: <a href="http://web001-chal03.wargame.whitehat.vn/">http://web001-chal03.wargame.whitehat.vn</a></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Mở url, ta được một form đăng nhập</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/a04353baf4b72dee88972b6f8d365965/tumblr_inline_op2n1nevfP1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Xem source trang, lấy được username/password: test/test</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/a405ae48128dd0e6b66d56acabc73416/tumblr_inline_op2ncywClE1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Đăng nhập thử, trang web báo không có quyền admin</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/fef15284ba72f4f6a5506601718219b6/tumblr_inline_op2nda8Khh1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Xem thử cookie, thấy có giá trị "user=test", thử đổi lại thành "user=admin" xem có hổng session không</p><figure data-orig-width="1080" data-orig-height="607" class="tmblr-full"><img src="https://68.media.tumblr.com/b6b71e6b50961d8c0baffaf510c4ea87/tumblr_inline_op2ndoCrNS1ux1xli_540.png" data-orig-width="1080" data-orig-height="607" alt="image"></figure><p>Flag :3</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/68d3d9730d9077d62cf070e162652cb4/tumblr_inline_op2ne3OY5y1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Flag: <b>WhiteHat{sha1(don't_believe_cookies_at_all)}</b></p><hr><p><b>

Web002</b></p><blockquote><p>Input right password in the following site and get you can the flag.</p><p>URL: <a href="http://web002-chal03.wargame.whitehat.vn/">http://web002-chal03.wargame.whitehat.vn</a></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Mở url, được form yêu cầu nhập password</p><figure data-orig-width="1080" data-orig-height="607" class="tmblr-full"><img src="https://68.media.tumblr.com/44c15aa278498ed4ed287054a6a95504/tumblr_inline_op2nowUZKs1ux1xli_540.png" data-orig-width="1080" data-orig-height="607" alt="image"></figure><p>Mình xem source site, thấy có đoạn javascript rất dài, nghi là JSFuck. Kiểm tra bằng cách xóa đoạn "()" ở cuối đi, thêm toString() vào và chạy thử. Được 1 đoạn function</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/738f178b5c83c5fd6084145360eb8e82/tumblr_inline_op2nqti7Qk1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Format lại script cho đúng chuẩn</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/8d3088c1288e1f229192e1db17ecd9b8/tumblr_inline_op2nrvQrF41ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Chạy đoạn script tìm giá trị của biến <b>wellplayed</b> để lấy password</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/39adf8c49ae4596c074a3ac0e26d83a8/tumblr_inline_op2nsd13gF1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Tìm thấy flag :))</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/550a77dcd0c497285a48acf331d87b8e/tumblr_inline_op2nsn2aL01ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Đoạn JSFuck ở bước 2: <a href="https://github.com/t-rekttt/WhiteHat-Challenge-03/blob/master/Writeups/resources/Web002-js-fuck.js">here</a></p><p>Flag: <b>WhiteHat{sha1(easy_javascript_right?)}</b></p><hr><p><b>

Crypto001</b></p><blockquote><p>I happen to get this text, but it seems to be encrypted. Decrypt it and find the hidden flag.</p><p><i>HJXAJY GPHTPR HPL P CPBDG APGTCTV SCP CPXRXIXADE DWL LTGWIGTKD TWI CPBDG RXAQJETG SCP STWHXAQPIHT TWI TAJG UD TWI HGDGTEBT. GPHTPR STHJ TWI HBTAQDGE SCP HEXWHSGPW UD TWI SDXGTE DI TIPTGR HXW CLD TBTGEJH APRXIXADE SCP NGPIXAXB GTLDE. VPAU HX TWI GPTN IPWI GPHPTR HPL CGDQ. CPBDG GDGTEBT HJXAJY GPHTPR HX STSGPVTG HP TCD UD TWI IHDB AJUGTLDE SCP AJUHHTRRJH HGTSPTA CX TWI NGDIHXW UD TWI SAGDL. HXW TUXA SCP HXW ICTADXK WIPTS TKPW CTTQ NATSXL STIPGQTATR CX TGJIPGTIXA SCP BAXU.</i></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Nghi ngờ đoạn văn bản được mã hóa bằng Caesar/Subtitution, nên mình tiến hành phân tích bằng phần mềm CrypTool. Mở CrypTool, paste đoạn văn bản ban đầu, chọn Analysis -&gt; Symmetric Encryption (basic) -&gt; Ciphertext-Only -&gt; Caesar. Phần mềm trả về kết quả tốt nhất (phần khoanh đỏ)</p><figure data-orig-width="1365" data-orig-height="728" class="tmblr-full"><img src="https://68.media.tumblr.com/61a7e5943aac2ed93874d81a06a39835/tumblr_inline_op2nv9GvAk1ux1xli_540.png" data-orig-width="1365" data-orig-height="728" alt="image"></figure><p>Sau khi kiểm tra vài từ thì mình nhận ra rằng đoạn văn bản đã được đảo lại hết các từ và các tiếng trong câu. Viết 1 đoạn JS để đảo lại câu.</p><figure data-orig-width="1080" data-orig-height="521" class="tmblr-full"><img data-img-key="607" data-orig-width="1080" data-orig-height="521" data-uploading-key="607" src="src" alt="image"></figure><p>Tìm thấy gợi ý flag:</p><blockquote><p>FLAG IS THE YEAR THAT CAESAR WAS BORN</p></blockquote><p>Google theo gợi ý là ra flag ngay :3</p><p>Flag: <b>WhiteHat(sha1(100))</b></p><hr><p><b>

Crypto002</b></p><blockquote><p>We have components of an RSA cryptosystem. Decrypt the cipher to get the flag.</p><p>RSA info:</p><ul><li><a href="https://vi.wikipedia.org/wiki/RSA_(m%C3%A3_h%C3%B3a)">https://vi.wikipedia.org/wiki/RSA_(m%C3%A3_h%C3%B3a)</a> Vietnamese</li><li><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">https://en.wikipedia.org/wiki/RSA_(cryptosystem)</a> English"</li></ul><p>Download RSA-info file here:</p><p><a href="http://material.wargame.whitehat.vn/challenges/3/Crypto002_c576122a778397b48fa2d0368e2e02a14df1db41.zip">http://material.wargame.whitehat.vn/challenges/3/Crypto002_c576122a778397b48fa2d0368e2e02a14df1db41.zip</a></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Sau khi tải file info về, mở lên được một số giá trị: n, p, q, e, c. Đây là các giá trị tham gia vào quá trình mã hóa RSA.</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/c53bc6509e93179f0e20b6df42640cec/tumblr_inline_op2nxnwql21ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Để giải mã được cần tìm private key (d). Mình dùng công cụ <a href="https://github.com/ius/rsatool">rsatool</a> để xử lý</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/56bb5821e0e613b100f684b78dfbe287/tumblr_inline_op2ny6CcRS1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Sau khi có đủ giá trị, ta tiến hành giải mã. Input data như trong ảnh chính là giá trị e đã được chuyển thành dạng hex. Sau khi giải mã ta lại được một chuỗi hex khác</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/e5201bba3ee5d99d201aaf3f0dfef747/tumblr_inline_op2nyrROBN1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p><br>Giải mã chuỗi hex, ta được flag</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/9c7649c395dc07c27ebf88406b8e87c9/tumblr_inline_op2nz13wQw1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Flag: <b>WhiteHat{sha1(simple_rsa_decryption)}</b></p><hr><p><b>

For001</b></p><blockquote><p>This piece of data is captured via USB port, look for the flag transferred through it.</p><p>You can use Wireshark to read the file pcapng.</p><p>Download file pcap here:</p><p><a href="http://material.wargame.whitehat.vn/challenges/3/For001_61fb3e6d8aa22c75362af02e798331bbf5b73a4b.zip">http://material.wargame.whitehat.vn/challenges/3/For001_61fb3e6d8aa22c75362af02e798331bbf5b73a4b.zip</a></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Mở file của btc cung cấp, được một file .pcapng chứa data</p><figure data-orig-width="781" data-orig-height="334" class="tmblr-full"><img src="https://68.media.tumblr.com/e6efa73ce40c566eaf3e904f47f183f7/tumblr_inline_op2o13Q1sY1ux1xli_540.png" data-orig-width="781" data-orig-height="334" alt="image"></figure><p>Do quen tay nên mình click đúp mở luôn file .pcapng, và thật tình cờ thư mục Flag cũng được giấu bằng cách nén vào trong file đó :v :v</p><figure data-orig-width="780" data-orig-height="336" class="tmblr-full"><img src="https://68.media.tumblr.com/7416be533b452f2f10415c27b305fa80/tumblr_inline_op2o1h3Owl1ux1xli_540.png" data-orig-width="780" data-orig-height="336" alt="image"></figure><p>Flag :3. Có lẽ ở bài này btc muốn làm khó bằng cách đánh lạc hướng người chơi vào việc đi tìm packet, nhưng may mắn thay vì mình không cài Wireshark nên mặc định Winrar được chọn để mở file, và mình vớ được flag =))</p><figure data-orig-width="781" data-orig-height="335" class="tmblr-full"><img src="https://68.media.tumblr.com/0171707fb296fc43ea6b61d4f04f699f/tumblr_inline_op2o1rFu0X1ux1xli_540.png" data-orig-width="781" data-orig-height="335" alt="image"></figure><p>Flag: <b>WhiteHat{sha1(Life is short, Smile while you still have teeth !)}</b></p><hr><p><b>

For002</b></p><blockquote><p>We have eavesdropped a piece of network data when a user signed in a website. Find the flag as his password.</p><p>You can use Wireshark to read the file pcapng.</p><p>Download file pcap here:</p><p><a href="http://material.wargame.whitehat.vn/challenges/3/For002_ca60a166cf35f9f0567826b31a457df75017bfbb.zip">http://material.wargame.whitehat.vn/challenges/3/For002_ca60a166cf35f9f0567826b31a457df75017bfbb.zip</a></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Việc phân tích packet bằng Fiddler thì đã quá quen thuộc với mình, thành một ngón nghề rồi :3, nên mở file lên là mình search ngay các requests có chứa từ "<b>password</b>". Trong 3 requests chứa từ đó lại chỉ có đúng 1 request có response header là 302 (header này để redirect khi user đăng nhập thành công). Nên nhìn cái là mình ra luôn flag :))</p><figure data-orig-width="1365" data-orig-height="726" class="tmblr-full"><img src="https://68.media.tumblr.com/fcec809488bbf9b67a4327231892a7e3/tumblr_inline_op2o4okAOA1ux1xli_540.png" data-orig-width="1365" data-orig-height="726" alt="image"></figure><p>Flag: <b>WhiteHat{sha1(@Bkav123#$challange3)}</b></p><hr><p><b>

Pwn002</b></p><blockquote><p>You are lucky, you can try your luck to pass our guessing game. Google search for something interesting.</p><p>Play game by using netcat: <b>nc 103.237.98.32 25032</b></p><p>Submit WhiteHat{sha1(flag)}</p></blockquote><p>Thử kết nối đến server, nhận được yêu cầu đoán 2 số. Mình nhập bừa thử 1 số thì nhận được thông báo nhập số trong giới hạn từ 100-1000</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/08f8264f9e602361d7e6afe558e3bb2c/tumblr_inline_op2o89Bm6i1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Mình viết 1 đoạn bash script để bruteforce số đầu tiên</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/42d9a7cab84660b2f2faa82e6ba37c16/tumblr_inline_op2o8x9CPZ1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Sau khi tìm được số đầu tiên là 576, server lại tiếp tục yêu cầu nhập số thứ 2, gợi ý là dùng hàm srand với time(0) trong C</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://68.media.tumblr.com/92f68c43be61fe5dd186e870d403f2bb/tumblr_inline_op2o9fwh6o1ux1xli_540.png" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Mình tiếp tục viết 1 chương trình C theo yêu cầu để tìm số tiếp theo</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://camo.githubusercontent.com/67578a62985a3775183f3980a48393d895827423/687474703a2f2f692e696d6775722e636f6d2f4f62766d3237622e706e67" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Craft 2 đoạn script lại thành 1 command: <code>(echo "576"; sleep 1s; ./a.out) | nc 103.237.98.32 25032</code>. Flag đây rồi :3</p><figure data-orig-width="1366" data-orig-height="768" class="tmblr-full"><img src="https://camo.githubusercontent.com/d4e0942aa1bc37f7926110cd018f3013cd65a957/687474703a2f2f692e696d6775722e636f6d2f787662694175632e706e67" data-orig-width="1366" data-orig-height="768" alt="image"></figure><p>Flag: <b>WhiteHat{sha1(Life_is_a_story_make_yours_the_best_seller.)}</b></p><hr></p>